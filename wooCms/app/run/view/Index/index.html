{extends file='../base.html'}
{block name=global}
<script type="text/javascript">
if (window.localStorage) {
    var default_theme = localStorage.getItem('woocms-theme');
    if (default_theme) {
        $('body').addClass(default_theme);
    }
}
var winWidth = $(window).width();
var winHight = $(window).height();
</script>
{$cms_menu = adminmenu('nav')|default:[]}
{$is_app_debug = config('app_debug')}
<div id="wooBase">
    <div class="woo-header clearfix">
        <span class="menuBar" id="closeSiderbar"><i class="layui-icon layui-icon-shrink-right"></i></span>
        <div class="header-left" id="topMenu">
            <ul class="grid">
                {foreach $cms_menu as $level0_id => $level0}
                {$is_top_display=true}
                {if !config('app_debug') && adminmenu($level0_id,'is_debug')}{$is_top_display=false}{/if}
                {if $is_top_display}
                {$is_power=true}
                {if (adminmenu($level0_id,'power_tree_id') and !in_array(adminmenu($level0_id,'power_tree_id'), $powers)) and !$is_super_power}{$is_power = false}{/if}
                {if $is_power}
                <li>{adminmenu($level0_id,'title')}</li>
                {/if}
                {/if}
                {/foreach}
                <li class="current"><i class="fa-globe fa"></i></li>
            </ul>
        </div>
        <div class="header-right">
            <ul class="layui-nav list" >
                <li class="layui-nav-item circle gohome first"><a   href="{url('Home/Index/index')}" target="_blank"><i class="layui-icon layui-icon-website"></i></a></li>
                <li class="layui-nav-item circle"><a class="javascript" rel="full_screen"  href="javascript:void(0);"><i class="layui-icon layui-icon-screen-full"></i></a></li>
                <li class="layui-nav-item circle"><a class="javascript" rel="select_theme"  href=""><i class="layui-icon layui-icon-theme" ></i></a></li>
                <li class="layui-nav-item circle"><a href="javascript:void(0);" class="javascript" rel="top_refresh"><i class="layui-icon layui-icon-refresh" ></i></a></li>
                
                <li class="layui-nav-item">
                    <a href="javascript:;" class="admin-user">
                        <span class="admin-user-headpic"><img  src="{$root}{$login.Member.headimg|default:'images/admin/default_headimg.png'}" alt=""/></span><span class="admin-user-name">{$login.Member.nickname|default:$login.username}</span>
                     </a>
                    <dl class="layui-nav-child">
                        <i class="i"></i>
                        <dd><a href="{url('User/modify',['id'=>$login.id])}" class="new_tab" data-icon="fa-user"><i class="fa fa-pencil" aria-hidden="true"></i>修改密码</a></dd>
                        <dd><a href="" class="javascript" rel="lockScreen"><i class="fa fa-lock" aria-hidden="true" style="padding-right: 2px;padding-left: 2px;"></i>锁屏(Alt+L)</a></dd>
                        <dd class="bt"><a href="{url('User/logout')}"><i class="fa fa-sign-out" aria-hidden="true"></i>注销登录</a></dd>
                    </dl>
                </li>
            </ul>
        </div>
    </div>
    <div class="woo-sider">
        <div class="woo-sider-scroll">
            <div class="woo-logo sizing">
                <h2 class="name">WOO<span class="cms">CMS</span></h2>                
            </div>
            <div class="woo-siderbar"> 
                <ul class="layui-nav layui-nav-tree" lay-shrink="all" lay-unselect>               
                {foreach $cms_menu as $level0_id => $level0}
                {if !$is_app_debug && adminmenu($level0_id, 'is_debug')}{continue}{/if}
                {if (adminmenu($level0_id, 'power_tree_id') and !in_array(adminmenu($level0_id, 'power_tree_id'), $powers)) and !$is_super_power}{continue}{/if}
                
                    {foreach $level0 as $level1_id => $level1}
                    {if !$is_app_debug && adminmenu($level1_id, 'is_debug')}{continue}{/if}                    
                    {if (adminmenu($level1_id, 'power_tree_id') and !in_array(adminmenu($level1_id, 'power_tree_id'), $powers)) and !$is_super_power}{continue}{/if}
                    <li class="layui-nav-item" data-group="{$level0@index}">
                        <a href="{url(adminmenu($level1_id, 'url'))}" data-icon="{adminmenu($level1_id, 'icon')}"><i  class="fa {adminmenu($level1_id,'icon')}"></i><cite>{adminmenu($level1_id,'title')}</cite></a>
                        {if $level1} 
                        <dl class="layui-nav-child">
                            {foreach $level1 as $level2_id => $level2}
                            {if !$is_app_debug && adminmenu($level2_id, 'is_debug')}{continue}{/if}                            
                            {if (adminmenu($level2_id, 'power_tree_id') and !in_array(adminmenu($level2_id, 'power_tree_id'), $powers)) and !$is_super_power}{continue}{/if}
                            <dd>
                                <a href="{url(adminmenu($level2_id,'url'))}" data-icon="{adminmenu($level2_id,'icon')|default:adminmenu($level1_id, 'icon')}"><cite>{adminmenu($level2_id, 'title')}</cite></a>
                                {if $level2} 
                                <dl class="layui-nav-child">
                                    {foreach $level2 as $level3_id => $level3}
                                    {if !$is_app_debug && adminmenu($level3_id, 'is_debug')}{continue}{/if}                            
                                    {if (adminmenu($level3_id, 'power_tree_id') and !in_array(adminmenu($level3_id, 'power_tree_id'), $powers)) and !$is_super_power}{continue}{/if}
                                    <dd>
                                        <a href="{url(adminmenu($level3_id,'url'))}" data-icon="{adminmenu($level3_id,'icon')|default:adminmenu($level1_id, 'icon')}"><cite>{adminmenu($level3_id, 'title')}</cite></a>
                                    </dd>
                                    {/foreach}
                                </dl>
                                {/if}                                
                            </dd>
                            {/foreach}
                        </dl>
                        {/if}
                    </li>
                    {/foreach}
                
                {/foreach}
                </ul>
            </div>
        </div>
    </div>
    
    <div id="wooRight" lay-allowClose="true">
        <div class="layui-tab admin-nav-card" lay-filter="admin-tab" >
            <div class="tab-title-bg"></div>           
            <a href="javascript:void(0);" class="tab-prev"><i class="fa fa-angle-double-left fa-2x"></i></a>
            <a href="javascript:void(0);" class="tab-next"><i class="fa fa-angle-double-right fa-2x"></i></a>
			<ul class="layui-tab-title">
				<li class="layui-this">
					<i class="layui-icon layui-icon-home" aria-hidden="true"></i><cite>后台首页</cite><b class="lt"></b><b class="rt"></b>
				</li>
			</ul>
			<div class="layui-tab-content">
				<div class="layui-tab-item layui-show admin_home">
                    <div class="admin_content">
                        <div class="layui-row layui-col-space15">
                            <div class="layui-col-md8">
                                <div class="layui-row layui-col-space15">
                                    <div class="layui-col-md6">
                                        <div class="layui-card b1">
                                            <div class="layui-card-header">快捷方式<a href="{url('Shortcut/lists')}" class="action new_tab" data-title="快捷方式" data-icon="layui-icon-star"><i class="layui-icon layui-icon-more-vertical"></i></a></div>
                                            <div class="layui-card-body">
                                                
                                                <div class="layui-carousel admin-carousel admin-shortcut" data-height="194">
                                                    <div carousel-item>
                                                        <!--自行在快捷方式模型中进行数据管理 可以添加任意多个 自动循环-->
                                                        <ul class="grid quick-link layui-row layui-col-space10">
                                                            {foreach $shortcut_list as $item}
                                                            <li class="layui-col-xs3">
                                                                <a href="{url($item.url)}" class="{if $item.type=='func'}javascript{/if} {if $item.type=='url' && $item.target=='tab'}new_tab{/if}" {if $item.type=='url' && $item.target=='blank'}target="_blank"{/if} {if $item.type=='url' && $item.target=='tab'}data-title="{$item.title}" data-icon="{$item.icon}"{/if}  {if $item.type=='func'}rel="{$item.func}"{/if}>
                                                                    <i class="{if strpos($item.icon, 'layui-icon') !== false}layui-icon {/if}{$item.icon}"></i>
                                                                    <span>{$item.title}</span>
                                                                </a>
                                                            </li>
                                                            {if $item@iteration%8 == 0 && !$item@last}
                                                            </ul>
                                                            <ul class="grid quick-link layui-row layui-col-space10">
                                                            {/if}
                                                            {/foreach}
                                                        </ul>
                                                    </div>
                                                </div>
                                                
                                            </div>
                                        </div>
                                    </div>
                                    <div class="layui-col-md6">
                                        <div class="layui-card b2">
                                            <div class="layui-card-header">数据统计</div>
                                            <div class="layui-card-body">
                                                <div class="layui-carousel admin-carousel admin-mcount" data-height="194">
                                                     <div carousel-item>
                                                        <!--自行添加更多的数据统计 每个ul显示4个li 数据自行在run/Index/index查询assign出来-->
                                                        <ul class="grid quick-link layui-row layui-col-space10">
                                                            <li class="layui-col-xs6">
                                                                <a href="{url('Article/lists')}" class="new_tab" data-title="文章列表" data-icon="fa-file-text">
                                                                    <h2>文章</h2>
                                                                    <span>{if $count.article<999}{$count.article}{else}999+{/if}</span>
                                                                </a>
                                                            </li>
                                                            <li class="layui-col-xs6">
                                                                <a href="{url('Product/lists')}" class="new_tab" data-title="产品列表" data-icon="fa-camera">
                                                                    <h2>产品</h2>
                                                                    <span>{if $count.product<999}{$count.product}{else}999+{/if}</span>
                                                                </a>
                                                            </li>
                                                            <li class="layui-col-xs6">
                                                                <a href="{url('Album/lists')}" class="new_tab" data-title="图集列表" data-icon="fa-image">
                                                                    <h2>图集</h2>
                                                                    <span>{if $count.album<999}{$count.album}{else}999+{/if}</span>
                                                                </a>
                                                            </li>
                                                            <li class="layui-col-xs6">
                                                                <a href="{url('feedback/lists')}" class="new_tab" data-title="留言列表" data-icon="layui-icon-cellphone">
                                                                    <h2>待阅留言</h2>
                                                                    <span>{if $count.feedback<999}{$count.feedback}{else}999+{/if}</span>
                                                                </a>
                                                            </li>
                                                        </ul>
                                                        <ul class="grid quick-link layui-row layui-col-space10">
                                                            <li class="layui-col-xs6">
                                                                <a href="{url('user/lists')}" class="new_tab" data-title="会员列表" data-icon="layui-icon-user">
                                                                    <h2>会员</h2>
                                                                    <span>{if $count.user<999}{$count.user}{else}999+{/if}</span>
                                                                </a>
                                                            </li>
                                                            <li class="layui-col-xs6">
                                                                <a onclick="layer.msg('敬请期待')">
                                                                    <h2>订单</h2>
                                                                    <span>0</span>
                                                                </a>
                                                            </li>
                                                            <li class="layui-col-xs6">
                                                                <a onclick="layer.msg('敬请期待')">
                                                                    <h2>消息</h2>
                                                                    <span>0</span>
                                                                </a>
                                                            </li>
                                                            <li class="layui-col-xs6">
                                                                <a onclick="layer.msg('敬请期待')">
                                                                    <h2>账单</h2>
                                                                    <span>0</span>
                                                                </a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!--这里显示你客户的基本信息-->
                                    <div class="layui-col-md6">
                                        <div class="layui-card b3">
                                            <div class="layui-card-header">使用企业<a href="{url('Setting/lists')}" class="action new_tab" data-title="系统设置" data-icon="layui-icon-set"><i class="layui-icon layui-icon-more-vertical"></i></a></div>
                                            <div class="layui-card-body">
                                                <ul class="list admin-use-info">
                                                    <li><i class="layui-icon layui-icon-flag"></i>公司：<span>{setting('corp_title')}</span></li>
                                                    <li><i class="layui-icon layui-icon-app"></i>网站：<span>{setting('site_title')}</span></li>
                                                    <li><i class="layui-icon layui-icon-website"></i>网址：<span class="en-font"><a href="{$absroot}" target="_blank">{$absroot}</a></span></li>
                                                    <li><i class="layui-icon layui-icon-cellphone"></i>电话：<span class="en-font">{setting('tel')}</span></li>
                                                    <li><i class="layui-icon layui-icon-dialogue"></i>邮箱：<span class="en-font">{setting('email')}</span></li>
                                                    <li><i class="layui-icon layui-icon-location"></i> 地址：<span>{setting('address')}</span></li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!--这里显示自己的相关信息 在应用/data/cache/Developer 自行修改-->
                                    <div class="layui-col-md6">
                                        <div class="layui-card b4">
                                            <div class="layui-card-header">开发企业</div>
                                            <div class="layui-card-body ">
                                                <ul class="list admin-use-info">                                                        
                                                    <li><i class="layui-icon layui-icon-flag"></i>公司：<span>{$dev.corp_title}</span></li>
                                                    <li><i class="layui-icon layui-icon-website"></i>网址：<span class="en-font"><a href="{$dev.site}" target="_blank">{$dev.site}</a></span></li>
                                                    <li><i class="layui-icon layui-icon-username"></i>客服：<span class="en-font">{$dev.customer}</span></li>
                                                    <li><i class="layui-icon layui-icon-cellphone"></i>电话：<span class="en-font">{$dev.tel}</span></li>
                                                    <li><i class="layui-icon layui-icon-dialogue"></i>邮箱：<span class="en-font">{$dev.email}</span></li>
                                                    <li><i class="layui-icon layui-icon-location"></i> 地址：<span>{$dev.address}</span></li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="layui-col-md12">
                                        <div class="layui-card b5">
                                            <div class="layui-card-header">数据分析</div>
                                            <div class="layui-card-body">
                                                <div class="layui-carousel admin-carousel admin-charts-box" lay-filter="charts" data-anim="fade" data-height="330">
                                                    <div carousel-item>
                                                        {foreach $charts as $item}
                                                        <div class="admin-charts"></div>
                                                        {/foreach}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                </div>
                                
                            </div>
                            <div class="layui-col-md4">
                                <div class="layui-card b6">
                                    <div class="layui-card-header">用户信息</div>
                                    <div class="layui-card-body">
                                        <div class="admin_user">
                                            <div class="admin_user_rght">
                                                <div class="headimg">
                                                    <i></i>
                                                    <a href="{url('Member/modify',['parent_id'=>$login.id])}" data-icon="fa-user" data-title="修改信息" class="new_tab"><img  src="{$root}{$login.Member.headimg|default:'images/admin/default_headimg.png'}" alt=""/></a>
                                                </div>
                                                <div class="welcome en-font">
                                                    您好！<span>{$login.Member.nickname|default:$login.username}</span>                                        
                                                    <a href="{url('User/logout')}" ><i style="color: red;" class="fa fa-sign-out" aria-hidden="true"></i></a>
                                                </div>
                                            </div>
                                            <div class="admin_user_left">
                                                <ul class="list">
                                                    <li>真实姓名：<span class="c">{$login.Member.truename|default:'未设置'}</span></li>
                                                    <li>用户分组：<span class="c">{$login.UserGroup.title}</span></li>                                                 
                                                    <li>登录地址：<span class="c">{$login.logined_ip}</span></li>
                                                    <li>登录时间：<span class="c">{$login.logined}</span></li>
                                                </ul>
                                                <div class="user_link layui-btn-group">
                                                    <a href="{url('UserScore/lists', ['parent_id' => $login.id])}" class="layui-btn layui-btn-primary new_tab" data-icon="layui-icon-senior" >我的积分</a>
                                                    <a href="{url('UserLogin/lists', ['parent_id' => $login.id])}" class="layui-btn layui-btn-primary new_tab" data-icon="layui-icon-chart-screen" >登录日志</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-card b7">
                                    <div class="layui-card-header">部署信息</div>
                                    <div class="layui-card-body">
                                        <div class="layui-carousel admin-carousel admin-env" data-autoplay="1" data-interval="10000" data-anim="fade" data-height="244">
                                            <div carousel-item>
                                                <div>
                                                    <table class="layui-table ">
                                                        <colgroup>
                                                            <col width="33.33%">
                                                            <col width="33.33%">
                                                            <col width="33.33%">
                                                        </colgroup>
                                                        <tr>
                                                            <th>配额限制</th>
                                                            <th>空间使用</th>
                                                            <th>域名到期</th>
                                                        </tr>
                                                        <tr>
                                                            <td>{$dev.storage_limit}</td>
                                                            <td><a href="{url('Tool/getSiteSize')}" class="javascript link" rel="get_site_size"><span id="showSiteSize" class="layui-badge layui-bg-orange">0KB</span></a></td>
                                                            <td>{$dev.domain_expire}</td>
                                                        </tr>
                                                        <tr>
                                                            <th>操作系统</th>
                                                            <th>服务器</th>
                                                            <th>服务器IP</th>
                                                        </tr>
                                                        <tr>
                                                            <td>{$dev.php_os}</td>
                                                            <td>{$dev.server_software}</td>
                                                            <td>{$dev.server_name}</td>
                                                        </tr>
                                                        <tr>
                                                            <th>上传限制</th>
                                                            <th>PHP</th>
                                                            <th>MYSQL</th>
                                                        </tr>
                                                        <tr>
                                                            <td>{$dev.upload_max_filesize}</td>
                                                            <td>{$dev.php_version}</td>
                                                            <td>{$dev.mysql_version}</td>
                                                        </tr>
                                                    </table>
                                                </div>
                                                <div>
                                                    <!--第二版信息可以自行添加更多-->
                                                    <table class="layui-table ">
                                                        <colgroup>
                                                            <col width="33.33%">
                                                            <col width="33.33%">
                                                            <col width="33.33%">
                                                        </colgroup>
                                                        <tr>
                                                            <th>PDO</th>
                                                            <th>CURL</th>
                                                            <th>MBstring</th>
                                                        </tr>
                                                        <tr>
                                                            <td>{$dev.pdo_extension}</td>
                                                            <td>{$dev.curl_extension}</td>
                                                            <td>{$dev.mbstring_extension}</td>
                                                        </tr>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!--可直接商用，版权信息文字和链接等内容禁止修改/删除/透明/隐藏/遮挡；具体请查看“使用协议”-->
                                <div class="layui-card woo-copyright b8">
                                    <div class="layui-card-header">软件信息<i class="layui-icon layui-icon-tips tooltip" data-tip-text="如有益求捐赠！" data-tip-type="1"></i></div>
                                    <div class="layui-card-body">
                                        <table class="layui-table">
                                            <colgroup>
                                                <col width="50%">
                                                <col width="50%">
                                            </colgroup>
                                            <tr>
                                                <th>WOOCMS</th>
                                                <th>THINKPHP</th>
                                            </tr>
                                            <tr>
                                                <td>{\woo\controller\WooApp::version()}</td>
                                                <td>{\App::version()}</td>
                                            </tr>
                                        </table>
                                        <div class="woo-link">
                                            <div class="layui-btn-group">
                                                <a href="https://www.eduaskcms.xin" target="_blank" class="layui-btn layui-btn-primary">系统官网</a>
                                                <a href="https://www.eduaskcms.xin/download/show/15.html" target="_blank" class="layui-btn layui-btn-primary">检查更新</a>
                                                <a href="https://www.eduaskcms.xin/addons.html" target="_blank" class="layui-btn layui-btn-primary">插件下载</a>
                                            </div>                                            
                                            <div class="layui-btn-group">
                                                <a href="https://www.kancloud.cn/laowu199/e_dev" target="_blank" class="layui-btn layui-btn-primary">开发手册</a>
                                                <a href="https://www.eduaskcms.xin/page/4.html" target="_blank" class="layui-btn layui-btn-primary">使用协议</a>
                                                <a href="//shang.qq.com/wpa/qunwpa?idkey=af4adc038e4a9d6cd04a80d2f4391d071274a004a86f4c889b9444a904f451c8" target="_blank" class="layui-btn layui-btn-primary">系统QQ群</a>
                                            </div>                                            
                                            <div class="layui-btn-group">
                                                <a href="https://www.eduaskcms.xin/dashang.html" target="_blank" class="layui-btn layui-btn-primary">赞助作者</a>
                                                <a href="https://www.eduaskcms.xin/service/2.html" target="_blank" class="layui-btn layui-btn-primary">商业授权</a>
                                                <a href="https://www.eduaskcms.xin/page/8.html" target="_blank" class="layui-btn layui-btn-primary">授权告示</a>
                                            </div>
                                        </div>
                                        <div class="Powered"><a href="https://www.eduaskcms.xin" target="_blank">© WOOCMS版权所有</a></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="lockScreen" {if $is_lock_screen}style="display: block;"{/if}>
    <div class="init">
        <div class="relative">
            <div class="lockTime en-font"></div>
            <div class="pic"><img  src="{$root}{$login.Member.headimg|default:'images/admin/default_headimg.png'}" alt=""/><p class="en-font">{$login.Member.nickname|default:$login.username}</p></div>
        </div>
        <div class="wrbox">
            <input  type="password" id="screenPwd" class="wrin" value="" autocomplete="off" placeholder="请输入密码解锁.."/><br /><button id="closeLock" class="layui-btn">立即解锁</button>
        </div>
    </div>
</div>

<div class="full-shade"></div>
<div class="woo-theme">
    <div class="layui-card">
        <div class="layui-card-header">后台主题</div>
        <div class="layui-card-body">
            <ul class="grid theme-list">
                {foreach $theme as $item}
                <li class="{$item.name}" data-name="{$item.name}" data-tip-text="{$item.title}" data-tip-type="{cycle values='2,4'}">
                    <div class="theme-header"  style="background-color:{$item.header_bg} ;"></div>
                    <div class="theme-sider" style="background-color: {$item.sider_bg};">
                        <div class="theme-logo" style="background-color: {$item.logo_bg};"></div>
                    </div>
                    <div class="border"></div>
                </li>
                {/foreach}
            </ul>
        </div>
    </div>
</div>

<script>
var charts_options = {json_encode($charts)};

layui.use(['element', 'tab', 'carousel'], function(){
    var element = layui.element;
    var carousel = layui.carousel;
    
    $('.woo-siderbar').find('a').each(function() {
        if ($(this).parent().find('dl').length) {
            $(this).attr('href', 'javascript:void(0);')
        }
    })
    
    Tab = layui.tab({ 
    	elem: '.layui-tab',
    	maxSetting: {
    		max: 20,
    		tipMsg: '最多只能开启20个'
    	},
    	contextMenu:true,
        autoRefresh:true
    });
    
    $('.admin-carousel').each(function() {
        carousel.render({
            elem: this
            ,width: '100%'
            ,height : $(this).data('height') + 'px'
            ,arrow: $(this).data('arrow') ? $(this).data('arrow') : 'none'
            ,anim : $(this).data('anim') ? $(this).data('anim') : 'default'
            ,trigger: $(this).data('trigger') ? $(this).data('trigger') : 'mouseover'
            ,autoplay: $(this).data('autoplay') ? true : false
            ,interval : $(this).data('interval') ? $(this).data('interval') : 3000
        });
    })
    
    carousel.on('change(charts)', function(obj){
        charts_change(null, 1)
    });     
    if (winWidth > 998) {
       charts_change(null, 1) 
    } else {
        charts_change()
    }
    
});


function charts_change(index, time) {
    time = time || 300;
    if (typeof(index) == 'undefined' || index === null) {
        index = $('.admin-charts-box').find('.layui-carousel-ind').find('li.layui-this').index();
    }  
    
    if (index >= 0) {
        $('.admin-charts:eq(' + index + ')').attr('_echarts_instance_', 0);
        setTimeout(function(){
            var myChart = echarts.init($('.admin-charts')[index]);
            myChart.setOption(charts_options[index]);
        }, time)
    }
}


// 测栏目
$('.woo-siderbar').on('click', 'a', function() {
    if ($('body').hasClass('close-bar-state')) {
        layer.close(layer.tips());
        $('#closeSiderbar').trigger('click');
    }
    
    if (!$(this).parent().find('dl').length) {
        var href  = $(this).attr('href');
        var title = $(this).data('title') || $(this).find('cite').text();
        if(!title)  title = $(this).text();        
        var icon  = $(this).data('icon') || $(this).closest('li').find('a:first').data('icon');
        
        if (winWidth < 1000) {
            $('#closeSiderbar').trigger('click');
            
            setTimeout(function() {
                if(typeof(Tab) != 'undefined') Tab.resize();
            }, 300)
        }
        
        Tab.tabAdd({
            title: title,
            href : href,
            icon : icon
        })
        return false;
    }
})

$('.woo-siderbar').find('li.layui-nav-item').hover(function() {
    if ($('body').hasClass('close-bar-state') && winWidth >= 1000) {
        var title = $(this).children('a').find('cite').text();
        layer.tips(title, $(this), {
            tips: [ 2, '#000'],
            time : 0
        });
    }
}, function(){
    if ($('body').hasClass('close-bar-state')) {
        layer.close(layer.tips());
    }
})


// 一级栏目切换
$('#topMenu').find('li').click(function(){
    var index = $(this).index();
    var length = $('#topMenu').find('li').length;
    if (index < length - 1) {
        $('.woo-siderbar').find('li.layui-nav-item').show().not('[data-group="' + index + '"]').hide();
    } else {
       $('.woo-siderbar').find('li.layui-nav-item').show()
    }
    $(this).closest('#topMenu').find('li.current').removeClass('current').end().find('li:eq('+index+')').addClass('current');
})


$('#closeSiderbar').click(function() {
    if ($('body').hasClass('close-bar-state')) {
        $('body').removeClass('close-bar-state').find('#closeSiderbar').find('i').removeClass('layui-icon-spread-left').addClass('layui-icon-shrink-right');
    } else {
        
        $('body').addClass('close-bar-state').find('#closeSiderbar').find('i').removeClass('layui-icon-shrink-right').addClass('layui-icon-spread-left');
    }
    charts_change()
})

//Tab
$(window).resize(function(){
    winWidth = $(window).width();
    winHight = $(window).height();
    
    if(typeof(Tab) != 'undefined') Tab.resize();
    
    if (winWidth <= 998) {
        if (!$('body').hasClass('close-bar-state')) {
            $('#closeSiderbar').trigger('click');
        }
    } else {
        if ($('body').hasClass('close-bar-state')) {
            $('#closeSiderbar').trigger('click');
        }
    }
    
    if (winWidth <= 768) {
        $('#topMenu').find('li:last').trigger('click');
    }
    
    charts_change()
}).trigger('resize')

$('.tab-prev').unbind('click').bind('click',function(){
    var left    = $('.layui-tab-title').position().left ;
    left  = left + 117 < 0 ? left + 117 : 0;
    $('.layui-tab-title').stop(true).animate({ left : left },500);
})

$('.tab-next').unbind('click').bind('click',function(){
    var left    = $('.layui-tab-title').position().left;
    var boxWid  = $('.layui-tab-title').width();
    var liWid   = 0;
    $('.layui-tab-title').children('span').remove().end().find('li').each(function(){
        liWid += $(this).outerWidth() ;
    })
    left  = left-117 > -(liWid-boxWid) ? left-117 :-(liWid-boxWid);
    if(left>0)left =  0;
    $('.layui-tab-title').stop(true).animate({ left : left },500);
})

// 刷新
function top_refresh() {
    location.reload();
}

// 主题选择
function select_theme() {
    $('.full-shade').fadeIn(200)
    $('.woo-theme').show().animate({
        right : 0
    }, 300)
}

$('.full-shade').click(function() {
    $('.full-shade').fadeOut(200)
    $('.woo-theme').show().animate({
        right : -305
    }, 300, function() {
        $(this).hide()
    })
})

$('.woo-theme .theme-list li').click(function() {
    if ($(this).hasClass('current')) return false;
    var index  = $(this).index();
    $('.woo-theme').find('li.current').removeClass('current').end().find('li:eq('+index+')').addClass('current');
    var classname = $(this).data('name');
    $('body').removeClass('black coffee purple-red ocean green yellow red-yellow-header ocean-header classic-black-header purple-red-header fashion-red-header default').addClass(classname);
    if (window.localStorage) {
        localStorage.setItem('woocms-theme', classname);
    } else {
        layer.msg('当前浏览器不支持');
    }
})

if (typeof(default_theme) != 'undefined') {
    if (default_theme)
        $('.woo-theme .theme-list li[data-name="' + default_theme +'"]').addClass('current'); 
    else
        $('.woo-theme .theme-list li[data-name="default"]').addClass('current'); 
} else {
    $('.woo-theme .theme-list li[data-name="default"]').addClass('current');
}
 

// 全屏
function full_screen() {
    if ($(this).hasClass('full')) {
        $(this).removeClass('full').find('i').removeClass('layui-icon-screen-restore').addClass('layui-icon-screen-full');
        if (document.exitFullscreen) { 
            document.exitFullscreen(); 
        } else if (document.msExitFullscreen) { 
            document.msExitFullscreen(); 
        } else if (document.mozCancelFullScreen) { 
            document.mozCancelFullScreen(); 
        } else if (document.webkitCancelFullScreen) { 
            document.webkitCancelFullScreen(); 
        } 
    } else {
        $(this).addClass('full').find('i').removeClass('layui-icon-screen-full').addClass('layui-icon-screen-restore');
        var docElm = document.documentElement; 
        if (docElm.requestFullscreen) { 
            docElm.requestFullscreen(); 
        } else if (docElm.msRequestFullscreen) { 
            docElm.msRequestFullscreen(); 
        } else if (docElm.mozRequestFullScreen) { 
            docElm.mozRequestFullScreen(); 
        } else if (docElm.webkitRequestFullScreen) { 
            docElm.webkitRequestFullScreen(); 
        } 
    }
}

function simple_clear(){
    var url = $(this).attr('href');
    HKUC.ajax_request.call(this,url,null,
    	{
    		'success':function(msg,data){
  		        layer.closeAll();
                layer.msg(msg)
    		},
    		'error':function(msg,data){
                  layer.closeAll();
                  layer.msg(msg)
    		}
    	}
    );
}

function switch_trace(){
    var url = $(this).attr('href');
    HKUC.ajax_request.call(this,url,null,
    	{
    		'success':function(msg,data){
  		        layer.closeAll();
                layer.msg(msg);
    		},
    		'error':function(msg,data){
                  layer.closeAll();
                  layer.msg(msg)
    		}
    	}
    );
}


function get_site_size(){
    var url = $(this).attr('href');
    layer.msg('查询中请稍后...',{ time:30*60*1000, shade :[0.01, '#393D49']});
    HKUC.ajax_request.call(this,url,null,
    	{
    		'success':function(msg,data){
                layer.closeAll();
                $('#showSiteSize').html(msg)
    		},
    		'error':function(msg,data){
                  layer.closeAll();
                  layer.msg(msg)
    		}
    	}
    );
}

function newTime(){
    var now  = new Date();
    var year = now.getFullYear() ;
    var month = (now.getMonth()+1) >=10 ? (now.getMonth()+1): '0' + (now.getMonth()+1);
    var date  = now.getDate() >=10 ? now.getDate(): '0' + now.getDate();
    var hour = now.getHours() >=10 ? now.getHours(): '0' + now.getHours();
    var minute = now.getMinutes() >=10 ? now.getMinutes(): '0' + now.getMinutes();
    var second = now.getSeconds() >=10 ? now.getSeconds(): '0' + now.getSeconds();
    var datetime = year + '-' + month + '-' + date + ' ' + hour + ':' + minute + ':' + second;
    //$('.showtime').html(datetime);
    $('.lockTime').html(hour + ':' + minute + ':' + second)
}
newTime()
setInterval(newTime,1000)


//同时按下alt+L锁屏
document.onkeydown = function(event){
    if (event.keyCode == 76 && event.altKey){
        lockScreen()
    }
}


//锁屏
function lockScreen(){
    if($('#lockScreen').is(':visible')) return false ; 
    $('#screenPwd').val('');   
    $('#lockScreen').fadeIn(300, function(){
        $('#closeLock').addClass('shake');
    })
    var url = "{url('Tool/lockScreen')}";
    HKUC.ajax_request.call(this,url,null,
    	{
    		'success':function(msg,data){
  		        layer.closeAll();
    		},
    		'error':function(msg,data){
                  layer.closeAll();
                  layer.msg(msg)
    		}
    	}
    );
}

$('#screenPwd').keyup(function(event){
    if (event.keyCode == 13) {
        $('#closeLock').trigger('click');
    }
})

$('#closeLock').click(function(){
    var url = "{url('Tool/relieveScreen')}";
    var pwd = $.trim($('#screenPwd').val());
    if (!pwd) {
       layer.msg('请先输入密码'); 
       return false;
    }
    HKUC.ajax_request.call(this,url,{
            pwd : pwd
        },
    	{
    		'success':function(msg,data){
    		    layer.closeAll();
  		        $('#lockScreen').fadeOut(300);
    		},
    		'error':function(msg,data){
                  layer.closeAll();
                  layer.msg(msg);
    		}
    	}
    );
})
</script>
{/block}